/**
 * layout.css - Platform-Grade Layout System
 * 
 * RULES:
 * - All public pages MUST use .page-container
 * - No full-width layouts except hero sections
 * - Consistent spacing throughout
 * - No random spacing values
 */

:root {
  /* ========================================
     LAYOUT TOKENS
     ======================================== */
  --page-max-width: 1140px;
  --page-padding-desktop: 24px;
  --page-padding-tablet: 20px;
  --page-padding-mobile: 16px;
  
  /* ========================================
     SPACING SCALE (No random values allowed)
     ======================================== */
  --space-1: 4px;
  --space-2: 8px;
  --space-3: 12px;
  --space-4: 16px;
  --space-5: 24px;
  --space-6: 32px;
  --space-7: 40px;
  --space-8: 48px;
  
  /* Semantic spacing */
  --section-gap: 48px;  /* Between major sections */
  --card-gap: 24px;     /* Between cards */
  --card-padding: 24px; /* Inside cards */
  
  /* ========================================
     BORDER RADIUS
     ======================================== */
  --card-radius: 12px;
  --input-radius: 10px;
  --button-radius: 10px;
  
  /* ========================================
     NAVBAR
     ======================================== */
  --navbar-height: 64px;
  --navbar-padding: var(--space-4);
  
  /* ========================================
     MOBILE SPECIFIC
     ======================================== */
  --mobile-nav-height: 64px;
  --mobile-layer-gap: 12px;
  --mobile-layer-0: calc(var(--mobile-nav-height) + env(safe-area-inset-bottom, 0px));
  --mobile-layer-1: calc(var(--mobile-layer-0) + var(--mobile-layer-gap));
  --mobile-layer-2: calc(var(--mobile-layer-1) + 56px + var(--mobile-layer-gap));
  --mobile-layer-3: calc(var(--mobile-layer-2) + 56px + var(--mobile-layer-gap));
}

/* ========================================
   PAGE CONTAINER - CANONICAL DEFINITION
   This is the ONLY place where page width is defined
   ======================================== */

.page-container {
  width: 100%;
  max-width: var(--page-max-width);
  margin: 0 auto;
  padding-left: var(--page-padding-mobile);
  padding-right: var(--page-padding-mobile);
  box-sizing: border-box;
}

/* Tablet */
@media (min-width: 768px) {
  .page-container {
    padding-left: var(--page-padding-tablet);
    padding-right: var(--page-padding-tablet);
  }
}

/* Desktop */
@media (min-width: 1024px) {
  .page-container {
    padding-left: var(--page-padding-desktop);
    padding-right: var(--page-padding-desktop);
  }
}

/* ========================================
   SECTION SPACING
   Consistent rhythm between sections
   ======================================== */

.section {
  padding-top: var(--section-gap);
  padding-bottom: var(--section-gap);
}

.section + .section {
  padding-top: 0; /* Avoid double spacing */
}

/* ========================================
   CARD SYSTEM
   Flat, matte, professional
   ======================================== */

.card {
  background: var(--color-surface);
  border: var(--border-soft);
  border-radius: var(--card-radius);
  padding: var(--card-padding);
  box-shadow: none; /* NO shadows on cards */
}

.card + .card {
  margin-top: var(--card-gap);
}

/* ========================================
   FLOATING LAYER SYSTEM (Mobile)
   ======================================== */

.floating-layer {
  transition:
    transform 160ms ease-out,
    opacity 120ms ease-out;
  will-change: transform, opacity;
}

.floating-layer.visible {
  opacity: 1;
  transform: translateY(0);
  pointer-events: auto;
}

.floating-layer.hidden {
  opacity: 0;
  transform: translateY(8px);
  pointer-events: none;
}

@media (prefers-reduced-motion: reduce) {
  .floating-layer {
    transition: none;
  }
  .floating-layer.hidden {
    transform: none;
  }
}

/* ========================================
   GRID SYSTEM (Optional)
   ======================================== */

.grid {
  display: grid;
  gap: var(--card-gap);
}

.grid-2 {
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
}

.grid-3 {
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
}

/* ========================================
   RESPONSIVE BREAKPOINTS
   ======================================== */

/* Mobile: < 768px (default) */
/* Tablet: 768px - 1023px */
@media (min-width: 768px) {
  :root {
    --navbar-height: 68px;
  }
}

/* Desktop: >= 1024px */
@media (min-width: 1024px) {
  :root {
    --navbar-height: 72px;
  }
}

/* ========================================
   FLEX SAFETY RULES - ONE SCROLL LAW

   RULES:
   1. PageViewport (#root) owns vertical scrolling
   2. No page may define height: 100vh/100% unless documented
   3. Scrollable regions MUST use flex: 1 + min-height: 0
   ======================================== */

/* Flex containers that may have scrollable children need min-height: 0 */
.feed-layout,
.feed-main,
.profile-layout,
.profile-content,
.settings-layout,
.settings-content,
.discover-layout,
.admin-layout {
  min-height: 0; /* FLEX SAFETY: Allow children to shrink properly */
}

/* Scrollable flex children */
.scrollable-content,
.scroll-container {
  flex: 1;
  min-height: 0;
  overflow-y: auto;
}

/* ========================================
   FLEX SAFETY (SCOPED — NOT GLOBAL)
   Prevents flex overflow without breaking inputs, images, or modals
   ======================================== */

.app-layout *,
.page-layout *,
.page-viewport *,
.messages-layout * {
  min-height: 0;
}

/* ========================================
   GLOBAL SCROLL OVERRIDE — FINAL AUTHORITY
   This block MUST be last in layout.css
   ======================================== */

html,
body,
#root {
  overflow-y: auto !important;
  overflow-x: hidden !important;
  height: auto !important;
  min-height: 100% !important;
}

/* Layout containers must never own scroll */
.app-layout,
.page-layout,
.messages-page,
.messages-layout {
  overflow: visible !important;
  height: auto !important;
}

/* page-viewport needs auto min-height to prevent content overlap */
.page-viewport {
  overflow: visible !important;
  height: auto !important;
}

/* Only explicit content lists may scroll */
.chat-messages,
.conversation-list,
.feed-list {
  overflow-y: auto;
}
