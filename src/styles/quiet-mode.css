/* ========================================
   QUIET MODE - SPACING & ANIMATION ONLY

   ⚠️ CRITICAL RULE (Phase 8):
   - Quiet Mode affects SPACING and ANIMATIONS only
   - NO color overrides (colors are Dark Mode's job)
   - This ensures Quiet Mode + Dark Mode work correctly together

   Main variables are defined in variables.css
   ======================================== */

/* ========================================
   SMOOTH TRANSITIONS
   Animate theme changes for pleasant UX
   ======================================== */

html {
  transition: background-color 0.3s ease-in-out;
}

/* Apply transition to common elements when quiet mode toggles */
[data-quiet="true"] *,
[data-quiet-mode="true"] * {
  transition:
    background-color 0.3s ease-in-out,
    color 0.3s ease-in-out,
    border-color 0.3s ease-in-out,
    box-shadow 0.3s ease-in-out;
}

/* ========================================
   QUIET MODE: REDUCED MOTION
   Disable non-essential animations
   ======================================== */

[data-quiet="true"],
[data-quiet-mode="true"] {
  /* Reduce animation speed globally */
  --animation-duration: 0.1s;
  --transition-duration: 0.1s;
}

/* Disable decorative animations in Quiet Mode */
[data-quiet="true"] .animated,
[data-quiet="true"] .pulse,
[data-quiet="true"] .bounce,
[data-quiet="true"] .shake,
[data-quiet-mode="true"] .animated,
[data-quiet-mode="true"] .pulse,
[data-quiet-mode="true"] .bounce,
[data-quiet-mode="true"] .shake {
  animation: none !important;
}

/* Reduce hover effects */
[data-quiet="true"] button:hover,
[data-quiet="true"] a:hover,
[data-quiet-mode="true"] button:hover,
[data-quiet-mode="true"] a:hover {
  transform: none;
}

/* Calm button states - no scale transforms */
[data-quiet="true"] .btn-join:hover,
[data-quiet="true"] .btn-leave:hover,
[data-quiet="true"] .join-btn:hover,
[data-quiet-mode="true"] .btn-join:hover,
[data-quiet-mode="true"] .btn-leave:hover,
[data-quiet-mode="true"] .join-btn:hover {
  transform: none;
  box-shadow: none;
}

/* ========================================
   QUIET MODE: SUBTLE FOCUS STATES
   Reduced emphasis for calm browsing
   ======================================== */

[data-quiet="true"] :focus-visible,
[data-quiet-mode="true"] :focus-visible {
  outline-width: 1px;
  outline-offset: 1px;
  box-shadow: none;
}

/* ========================================
   QUIET MODE: NO SURPRISE UI CHANGES
   Predictable, calm interface
   ======================================== */

/* Don't animate notification badges */
[data-quiet="true"] .notification-badge,
[data-quiet="true"] .unread-badge,
[data-quiet-mode="true"] .notification-badge,
[data-quiet-mode="true"] .unread-badge {
  animation: none;
}

/* Softer toast notifications */
[data-quiet="true"] .toast,
[data-quiet-mode="true"] .toast {
  animation: none;
  opacity: 0.9;
}

/* ========================================
   PREFERS-REDUCED-MOTION SYNC
   Honor system preference
   ======================================== */

@media (prefers-reduced-motion: reduce) {
  [data-quiet="true"],
  [data-quiet-mode="true"] {
    /* Already reduced, ensure it stays that way */
  }

  /* Force reduced motion for all users who prefer it */
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* ==================================================
   TABLET POLISH PASS (768px–1023px)
   ================================================== */

@media (min-width: 768px) and (max-width: 1023px) {

  /* Global spacing rhythm */
  .container,
  .page,
  .layout {
    padding-left: 20px;
    padding-right: 20px;
  }

  /* Cards & surfaces */
  .card,
  .panel,
  .surface {
    border-radius: 14px;
    box-shadow: none;
    border: 1px solid rgba(255,255,255,0.06);
  }

  /* Messages */
  .messages-layout {
    gap: 16px;
  }

  .message-bubble {
    max-width: 82%;
    padding: 10px 14px;
    border-radius: 16px;
  }

  /* Groups */
  .group-card {
    padding: 16px;
  }

  /* Profile header */
  .profile-header {
    padding: 20px;
  }

  .profile-avatar {
    width: 88px;
    height: 88px;
  }
}

/* ==================================================
   QUIET MODE — SPACING & ANIMATION ONLY

   ⚠️ CRITICAL: Phase 8 refactor
   - Quiet Mode affects SPACING and ANIMATIONS only
   - NO color overrides (colors are Dark Mode's responsibility)
   - This ensures Quiet Mode + Dark Mode work together correctly
   ================================================== */

/* ========================================
   QUIET MODE: SPACING TOKENS
   Increase vertical rhythm for calmer reading
   ======================================== */

[data-quiet="true"],
[data-quiet-mode="true"] {
  /* Increase spacing for breathing room */
  --quiet-space-multiplier: 1.25;

  /* Card/Surface spacing - more generous */
  --space-card-padding: calc(var(--space-4) * 1.25);

  /* List item gaps - more vertical rhythm */
  --space-list-gap: calc(var(--space-4) * 1.25);

  /* Reduced shadow intensity */
  --shadow-quiet: none;
}

/* ========================================
   QUIET MODE: LAYOUT SPACING ADJUSTMENTS
   ======================================== */

[data-quiet="true"] .feed-main,
[data-quiet-mode="true"] .feed-main {
  gap: calc(var(--space-md) * 1.25);
}

[data-quiet="true"] .post-card,
[data-quiet-mode="true"] .post-card {
  padding: calc(var(--space-4) * 1.25);
  box-shadow: var(--shadow-quiet, none);
}

[data-quiet="true"] .messages-list,
[data-quiet-mode="true"] .messages-list {
  gap: calc(var(--space-3) * 1.25);
}

[data-quiet="true"] .message-bubble,
[data-quiet-mode="true"] .message-bubble {
  padding: calc(var(--space-3) * 1.25) calc(var(--space-4) * 1.25);
}

/* Groups spacing */
[data-quiet="true"] .groups-grid,
[data-quiet-mode="true"] .groups-grid {
  gap: calc(var(--space-4) * 1.25);
}

[data-quiet="true"] .group-card,
[data-quiet-mode="true"] .group-card {
  padding: calc(var(--space-4) * 1.25);
}

/* Profile spacing */
[data-quiet="true"] .profile-header,
[data-quiet-mode="true"] .profile-header {
  padding: calc(var(--space-5) * 1.25);
}

/* Lounge spacing */
[data-quiet="true"] .lounge-feed,
[data-quiet-mode="true"] .lounge-feed {
  gap: calc(var(--space-5) * 1.25);
}

[data-quiet="true"] .lounge-post,
[data-quiet-mode="true"] .lounge-post {
  padding: calc(var(--space-4) * 1.25);
}

/* Journal spacing */
[data-quiet="true"] .journal-editor textarea,
[data-quiet-mode="true"] .journal-editor textarea {
  padding: calc(var(--space-5) * 1.25);
  line-height: 1.8;  /* More vertical rhythm in long-form content */
}

/* ========================================
   QUIET MODE: SHADOW REDUCTION
   Remove visual noise, not colors
   ======================================== */

[data-quiet="true"] .card,
[data-quiet="true"] .panel,
[data-quiet="true"] .surface,
[data-quiet-mode="true"] .card,
[data-quiet-mode="true"] .panel,
[data-quiet-mode="true"] .surface {
  box-shadow: none;
}

[data-quiet="true"] .group-card:hover,
[data-quiet-mode="true"] .group-card:hover {
  box-shadow: none;
  transform: none;
}

/* ========================================
   QUIET MODE: ACTION OPACITY REDUCTION
   Make actions feel less urgent
   ======================================== */

[data-quiet="true"] .post-actions,
[data-quiet="true"] .lounge-post-actions,
[data-quiet-mode="true"] .post-actions,
[data-quiet-mode="true"] .lounge-post-actions {
  opacity: 0.7;
}

[data-quiet="true"] .post-actions:hover,
[data-quiet="true"] .lounge-post-actions:hover,
[data-quiet-mode="true"] .post-actions:hover,
[data-quiet-mode="true"] .lounge-post-actions:hover {
  opacity: 1;
}
